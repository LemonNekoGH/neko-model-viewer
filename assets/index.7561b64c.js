var u=Object.defineProperty;var f=(t,e,r)=>e in t?u(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var l=(t,e,r)=>(f(t,typeof e!="symbol"?e+"":e,r),r);import{S as p,P as h,C as m,W as g,s as v,a as w,R as E,O as y,d as C,t as d,D,G as _,c as L,b as a,e as R,f as b,w as c,o as F,g as O}from"./vendor.47373aa4.js";const k=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}};k();class A{constructor(e,r){l(this,"renderer");l(this,"scene");l(this,"camera");l(this,"logRenderTimes");l(this,"group");this.logRenderTimes=!0,this.group=e,this.scene=new p,this.camera=new h(50,r.offsetWidth/r.offsetHeight,.1,2e3),this.camera.position.set(0,0,5),this.scene.background=new m(14082047),this.scene.add(e),this.renderer=new g({canvas:r,antialias:!0}),this.renderer.outputEncoding=v,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(innerWidth,innerHeight);const i=new w(this.renderer);this.scene.environment=i.fromScene(new E).texture,window.addEventListener("resize",()=>{this.camera.aspect=r.offsetWidth/r.offsetHeight,this.camera.updateProjectionMatrix()});const s=new y(this.camera,r);s.enableDamping=!0;let n=0;const o=()=>{n++,n%60==0&&this.logRenderTimes,requestAnimationFrame(o),s.update(),this.renderer.render(this.scene,this.camera)};o()}setGroup(e){this.scene.remove(this.group),this.scene.add(e),this.group=e}}var P=(t,e)=>{for(const[r,i]of e)t[r]=i;return t};const $=C({data(){return{loading:!1,selecting:!1,scene:null,viewer:null,file:null}},watch:{scene(t){t?this.viewer?this.viewer.setGroup(d(t)):this.viewer=new A(d(t),this.$refs.modelView):this.viewer=null}},methods:{onUploadClick(){if(!this.$refs.fileInput)return;this.selecting=!0,this.$refs.fileInput.click(),window.addEventListener("focus",()=>{this.selecting=!1},{once:!0})},async onFileChanged(t){if(!t.target)return;const e=t.target.files;if(!e){console.log("\u53D6\u6D88\u4E86\u9009\u62E9");return}const r=e[0];this.file=r;const i=new D;i.setDecoderPath("https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/libs/draco/");const s=new _;s.setDRACOLoader(i);try{this.loading=!0,s.parse(await r.arrayBuffer(),"",this.loadComplete,this.loadError)}catch(n){this.loadError(new ErrorEvent("ModelLoadError",{error:n,message:n.message}))}},loadComplete(t){this.loading=!1,this.scene=t.scene},loadError(t){this.loading=!1},onDrop(t){const e=t.dataTransfer;if(e&&e.files.item(0)){const i=this.$refs.fileInput;i.files=e.files,i.dispatchEvent(new Event("change"))}},onDragOver(t){}}}),B={class:"app"},G={class:"header"},I=a("span",{class:"header-title"}," \u6A21\u578B\u67E5\u770B\u5668 ",-1),M=a("div",{class:"spacer"},null,-1),T={class:"btn-content"},S=a("i",{class:"fas fa-folder-open"},null,-1),N=a("div",{class:"w-10px"},null,-1),V={ref:"modelView",class:"model-viewer"};function W(t,e,r,i,s,n){return F(),L("div",B,[a("header",G,[I,M,a("input",{style:{display:"none"},type:"file",ref:"fileInput",onChange:e[0]||(e[0]=(...o)=>t.onFileChanged&&t.onFileChanged(...o))},null,544),a("button",{class:"btn",onClick:e[1]||(e[1]=(...o)=>t.onUploadClick&&t.onUploadClick(...o))},[a("div",T,[S,R(" "+b(t.scene?"\u66F4\u6362\u8981\u9884\u89C8\u7684\u6587\u4EF6":"\u4E0A\u4F20\u6587\u4EF6\u8FDB\u884C\u9884\u89C8"),1)])]),N]),a("main",{class:"main",onDrop:e[2]||(e[2]=c((...o)=>t.onDrop&&t.onDrop(...o),["prevent"])),onDragover:e[3]||(e[3]=c((...o)=>t.onDragOver&&t.onDragOver(...o),["prevent"]))},[a("canvas",V,null,512)],32)])}var j=P($,[["render",W]]);O(j).mount("#app");
