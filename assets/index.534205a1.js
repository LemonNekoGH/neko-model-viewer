var u=Object.defineProperty;var f=(t,e,n)=>e in t?u(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var l=(t,e,n)=>(f(t,typeof e!="symbol"?e+"":e,n),n);import{S as p,P as h,C as m,W as g,s as w,a as v,R as y,O as C,d as E,t as d,D,G as _,c as R,b as a,e as L,f as b,w as c,o as F,g as O}from"./vendor.47373aa4.js";const k=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}};k();class A{constructor(e,n){l(this,"renderer");l(this,"scene");l(this,"camera");l(this,"logRenderTimes");l(this,"group");this.logRenderTimes=!0,this.group=e,this.scene=new p,this.camera=new h(50,n.offsetWidth/n.offsetHeight,.1,2e3),this.camera.position.set(0,0,5),this.scene.background=new m(14082047),this.scene.add(e),this.renderer=new g({canvas:n,antialias:!0}),this.renderer.outputEncoding=w,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(innerWidth,innerHeight);const o=new v(this.renderer);this.scene.environment=o.fromScene(new y).texture,window.addEventListener("resize",()=>{this.camera.aspect=n.offsetWidth/n.offsetHeight,this.camera.updateProjectionMatrix()});const s=new C(this.camera,n);s.enableDamping=!0;let r=0;const i=()=>{r++,r%60==0&&this.logRenderTimes&&console.log(`Rendered times: ${r/60}s`),requestAnimationFrame(i),s.update(),this.renderer.render(this.scene,this.camera)};i()}setGroup(e){this.scene.remove(this.group),this.scene.add(e),this.group=e}}var P=(t,e)=>{for(const[n,o]of e)t[n]=o;return t};const $=E({data(){return{loading:!1,selecting:!1,scene:null,viewer:null,file:null}},watch:{scene(t){t?this.viewer?this.viewer.setGroup(d(t)):this.viewer=new A(d(t),this.$refs.modelView):this.viewer=null}},methods:{onUploadClick(){if(!this.$refs.fileInput)return;this.selecting=!0,this.$refs.fileInput.click(),window.addEventListener("focus",()=>{this.selecting=!1},{once:!0})},async onFileChanged(t){if(!t.target)return;const e=t.target.files;if(!e){console.log("\u53D6\u6D88\u4E86\u9009\u62E9");return}const n=e[0];this.file=n;const o=new D;o.setDecoderPath("https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/libs/draco/");const s=new _;s.setDRACOLoader(o);try{this.loading=!0,s.parse(await n.arrayBuffer(),"",this.loadComplete,this.loadError)}catch(r){this.loadError(r)}},loadComplete(t){this.loading=!1,this.scene=t.scene},loadError(t){this.loading=!1},onDrop(t){const e=t.dataTransfer;if(e&&e.files.item(0)){const o=this.$refs.fileInput;o.files=e.files,o.dispatchEvent(new Event("change"))}},onDragOver(t){}}}),B={class:"app"},G={class:"header"},I=a("span",{class:"header-title"}," \u6A21\u578B\u67E5\u770B\u5668 ",-1),T=a("div",{class:"spacer"},null,-1),M={class:"btn-content"},S=a("i",{class:"fas fa-folder-open"},null,-1),N=a("div",{class:"w-10px"},null,-1),V={ref:"modelView",class:"model-viewer"};function W(t,e,n,o,s,r){return F(),R("div",B,[a("header",G,[I,T,a("input",{style:{display:"none"},type:"file",ref:"fileInput",onChange:e[0]||(e[0]=(...i)=>t.onFileChanged&&t.onFileChanged(...i))},null,544),a("button",{class:"btn",onClick:e[1]||(e[1]=(...i)=>t.onUploadClick&&t.onUploadClick(...i))},[a("div",M,[S,L(" "+b(t.scene?"\u66F4\u6362\u8981\u9884\u89C8\u7684\u6587\u4EF6":"\u4E0A\u4F20\u6587\u4EF6\u8FDB\u884C\u9884\u89C8"),1)])]),N]),a("main",{class:"main",onDrop:e[2]||(e[2]=c((...i)=>t.onDrop&&t.onDrop(...i),["prevent"])),onDragover:e[3]||(e[3]=c((...i)=>t.onDragOver&&t.onDragOver(...i),["prevent"]))},[a("canvas",V,null,512)],32)])}var j=P($,[["render",W]]);O(j).mount("#app");
